<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quill Code Copy</title>
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
  <style>
    body { font-family: Arial; margin: 20px; }
    #editor { height: 300px; margin-bottom: 20px; }
    #preview { border: 1px solid #ccc; padding: 10px; background: #f9f9f9; }
    pre { position: relative; padding: 10px; overflow-x: auto; background: #2d2d2d; color: #f8f8f2; }
    .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: #4CAF50;
      color: white;
      border: none;
      padding: 4px 8px;
      cursor: pointer;
      font-size: 12px;
      border-radius: 3px;
    }
    .copy-btn:hover { background: #45a049; }
  </style>
</head>
<body>

<h2>Quill Editor + Code Highlight + Copy Button</h2>

<div id="editor"></div>

<h3>Preview:</h3>
<div id="preview"></div>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/php.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/java.min.js"></script>

<script>
const quill = new Quill('#editor', {
  theme: 'snow',
  modules: {
    toolbar: [
      ['bold','italic','underline','strike','blockquote','code-block'],
      [{ 'header': 1 }, { 'header': 2 }],
      [{ 'list': 'ordered'}, { 'list': 'bullet' }],
      [{ 'indent': '-1'}, { 'indent': '+1' }],
      [{ 'size': ['small', false, 'large', 'huge'] }],
      [{ 'color': [] }, { 'background': [] }],
      [{ 'font': [] }],
      [{ 'align': [] }],
      ['link','image','video','formula'],
      ['clean']
    ]
  }
});

// Live preview with syntax highlight + copy button
quill.on('text-change', () => {
  const preview = document.getElementById('preview');
  preview.innerHTML = quill.root.innerHTML;

  // Highlight code blocks
  preview.querySelectorAll('pre.ql-syntax').forEach((block) => {
    hljs.highlightElement(block);

    // Add copy button if not added yet
    if (!block.querySelector('.copy-btn')) {
      const btn = document.createElement('button');
      btn.textContent = 'Copy';
      btn.className = 'copy-btn';
      btn.onclick = () => {
        navigator.clipboard.writeText(block.innerText)
          .then(() => alert('Code copied!'))
          .catch(() => alert('Copy failed!'));
      };
      block.appendChild(btn);
    }
  });
});
</script>

</body>
</html>