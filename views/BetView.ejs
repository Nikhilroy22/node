<%- include('header') %>
 
 
  <div class="match-wrapper">
  <div id="matchscore">Loading ...</div>
</div>
  
  
  <input type="hidden" id="hiddenId" value="<%= matchid %>" />
  
<!-- Tabs -->
      <div class="tabs" id="betoddstabs"></div>
      <div id="tabdata"></div>
      
    <script>
    const hiddenInput = document.getElementById("hiddenId");
    
console.log(hiddenInput.value)


let prevS1 = 0, prevS2 = 0, prevPoints1 = 0, prevPoints2 = 0, fst = true; // ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£

async function viewodds() {
    const matchscore = document.getElementById("matchscore");

    const res = await fetch(`/resview/${hiddenInput.value}`);
    const data = await res.json();

    const PS = data?.Value?.SC?.PS || [];
    const FS = data?.Value?.SC?.FS || {};
    const lastSet = PS.length > 0 ? PS[PS.length - 1].Value : { S1: 0, S2: 0, NF: "-" };
    if(fst){
      // ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    prevS1 = FS.S1 ?? 0;
    prevS2 = FS.S2 ?? 0;
    prevPoints1 = data?.Value?.SC.SS?.S1 ?? lastSet.S1 ?? 0;
    prevPoints2 = data?.Value?.SC?.SS?.S2 ?? lastSet.S2 ?? 0;
    fst = false;
    }

    matchscore.innerHTML = "";
    matchscore.className = "matchscore";

    /* HEADER */
    const matchheader = document.createElement("div");
    matchheader.className = "match-header";
    matchheader.innerHTML = `
        <span class="title">${data?.Value?.SN === "Badminton" ? "üè∏" : data?.Value?.SN === "Tennis" ? "üéæ" : data?.Value?.SN === "Football" ? "‚öΩÔ∏è" : data?.Value?.SN === "Cricket" ? "üèè" : ""} ${data?.Value?.L || ""}</span>
        <span class="status live">LIVE</span>`;
    matchscore.appendChild(matchheader);

    /* TEAMS */
    const teams = document.createElement("div");
    teams.className = "teams";
    teams.innerHTML = `
        <div class="team">
            <span class="name">${data?.Value?.O1 || "-"}</span>
            <span class="serve ${data?.Value?.SC.P == "1" ? "" : "off"}">üéæ</span>
            <span class="score" id="score1">${FS.S1 ?? 0}</span>
            <span class="points" id="points1">${data?.Value?.SC.SS?.S1 ?? lastSet.S1 ?? 0}</span>
        </div>

        <div class="vs">VS</div>

        <div class="team">
            <span class="name">${data?.Value?.O2 || "-"}</span>
            <span class="serve ${data?.Value?.SC.P == "2" ? "" : "off"}">üéæ</span>
            <span class="score" id="score2">${FS.S2 ?? 0}</span>
            <span class="points" id="points2">${data?.Value?.SC?.SS?.S2 ?? lastSet.S2 ?? 0}</span>
        </div>`;
    matchscore.appendChild(teams);

    /* ‡¶´‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶ö‡ßá‡¶ï */
    const score1El = document.getElementById("score1");
    const score2El = document.getElementById("score2");
    const points1El = document.getElementById("points1");
    const points2El = document.getElementById("points2");

    if ((FS.S1 ?? 0) !== prevS1) {
        score1El.classList.add("flash");
        //setTimeout(() => score1El.classList.remove("flash"), 2000);
    }
    if ((FS.S2 ?? 0) !== prevS2) {
        score2El.classList.add("flash");
        //setTimeout(() => score2El.classList.remove("flash"), 2000);
    }
    if ((data?.Value?.SC.SS?.S1 ?? lastSet.S1 ?? 0) !== prevPoints1) {
        points1El.classList.add("flash");
        //setTimeout(() => points1El.classList.remove("flash"), 2000);
    }
    if ((data?.Value?.SC?.SS?.S2 ?? lastSet.S2 ?? 0) !== prevPoints2) {
        points2El.classList.add("flash");
        //setTimeout(() => points2El.classList.remove("flash"), 2000);
    }

    // ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    prevS1 = FS.S1 ?? 0;
    prevS2 = FS.S2 ?? 0;
    prevPoints1 = data?.Value?.SC.SS?.S1 ?? lastSet.S1 ?? 0;
    prevPoints2 = data?.Value?.SC?.SS?.S2 ?? lastSet.S2 ?? 0;

    /* SET TABLE */
    const ttst = document.createElement("div");
    ttst.className = "newset";

    PS.forEach(s => {
        ttst.innerHTML += `
            <div class="set-box">
                <span class="set-name">${s?.Value?.NF || "-"}</span>
                <span class="set-score">${s?.Value?.S1 ?? 0} : ${s?.Value?.S2 ?? 0}</span>
            </div>
        `;
    });

    matchscore.appendChild(ttst);

    setTimeout(viewodds, 5000);
}

// Viewodds call
viewodds();



  </script>  



  

  <script>
   const tabData = [
    { id: "home", name: "Regular time", content: 'r' },
    { id: "1st", name: "1st set", content: '1' },
    { id: "2set", name: "2st set", content: '2' },
   
  ];
    
    const tabsContainer = document.getElementById('betoddstabs');
    const app = document.getElementById('tabdata');
    
    // ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡¶æ
  tabData.forEach((tab, index) => {
    const tabDiv = document.createElement('div');
    tabDiv.classList.add('tab');
    tabDiv.textContent = tab.name;
    tabDiv.addEventListener('click', () => changeTab(tab.id));
    tabsContainer.appendChild(tabDiv);
  });
  changeTab("home");
  
  function changeTab(tabId, fromHash = false) {
    // ‡¶∏‡¶¨ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ inactive
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

    // ‡¶ï‡ßã‡¶® ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨‡¶ü‡¶ø?
    const activeTab = tabData.find(t => t.id === tabId) || tabData[0];

    // UI ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
    const index = tabData.indexOf(activeTab);
    document.querySelectorAll('.tab')[index].classList.add('active');
    app.innerHTML = activeTab.content;

   
   
  } 
  </script>
  
 


<%- include('footer') %>
  
  